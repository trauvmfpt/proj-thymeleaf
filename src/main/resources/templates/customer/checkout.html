<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link type="text/css" th:href="@{/less/style.css}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700,300"
          th:href="@{'https://fonts.googleapis.com/css?family=Roboto:400,500,700,300'}" rel="stylesheet" type="text/css">
    <link href="../../static/css/bootstrap.min.css"
          th:href="@{/css/bootstrap.min.css}" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="../../static/css/style.css"
          th:href="@{/css/style.css}" >
    <link href="../../static/css/menu.css" th:href="@{/css/menu.css}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../../static/css/icon_fonts/css/all_icons.min.css"
          th:href="@{/css/icon_fonts/css/all_icons.min.css}" >
    <link href="../../static/css/custom.css" th:href="@{/css/custom.css}" rel="stylesheet">

    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        rel="stylesheet">
    <link rel="stylesheet" th:href="@{/sweetalert2/dist/sweetalert2.css}">
    <style>
        .checkout-content{
            display: none;
        }
    </style>
</head>
<body>

    <div class="super_container">
        <!--admin-header.html  that's here  -->
        <div th:replace="fragment/header :: header"></div>

        <div layout:fragment="content">
            <div id="position" style="margin-top: 60px;">
                <div class="container">
                    <ul>
                        <li><a href="#">Home</a>
                        </li>
                        <li><a href="#">Check out</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!--     End position -->

            <!-- BLOG -->
            <div style="margin: 20px;">
                <section class="section-checkout">
                    <div class="container">
                        <div class="checkout">

                            <div class="row">
                                <form th:if="${orderProduct}!= null" th:object="${orderProduct}" id="formform">
                                        <div class="col-md-6">
                                            <div class="checkout_head">
                                                <h3>BILLING DETAILS</h3>
                                            </div>

                                            <div class="checkout_form">

                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <label>Name</label>
                                                        <input th:field="*{customerName}" type="text" class="field-text">
                                                    </div>

                                                    <div class="col-xs-6 col-sm-6">
                                                        <label>Email Address*</label>
                                                        <input th:field="*{customerEmail}" type="text" class="field-text">
                                                    </div>

                                                    <div class="col-xs-6 col-sm-6">
                                                        <label>Phone*</label>
                                                        <input th:field="*{customerPhone}" type="text" class="field-text">
                                                    </div>

                                                    <div class="col-xs-12 col-sm-12">
                                                        <label>Notes</label>
                                                        <textarea th:field="*{note}" class="field-textarea" placeholder="Notes about your order, eg. special notes for studio/photographer"></textarea>
                                                    </div>
                                                    <div>
                                                        <input style="display: none;"
                                                               th:value="${accountId}"
                                                               name="accountId">
                                                    </div>

                                                </div>

                                            </div>
                                        </div>

                                        <div class="col-md-6">

                                            <div class="checkout_head checkout_margin">
                                                <h3>Your payment details</h3>
                                            </div>

                                            <div class="checkout_form checkout_margin">

                                                <div class="checkout_cart">

                                                    <!-- ITEM -->
                                                    <div class="cart-item" th:each="orderDetail : ${orderDetails}">
                                                        <div class="img">
                                                            <a th:href="@{/product/{id}(id = ${orderDetail.product.getId()})}"><img th:src="${orderDetail.product.thumbnail}" alt=""></a>
                                                        </div>
                                                        <div class="text">
                                                            <a th:href="@{/product/{id}(id = ${orderDetail.product.getId()})}" th:text="${orderDetail.product.name}"></a>
                                                            <p>
                                                                <span th:text="${orderDetail.product.photographerInfo != null ? orderDetail.product.photographerInfo.fullName : orderDetail.product.studioInfo.fullName}"></span>
                                                                <b th:text="${orderDetail.currentPrice}">(price)</b>
                                                            </p>
                                                        </div>
                                                        <a href="#" class="remove"><i class="fa fa-close"></i></a>
                                                    </div>
                                                    <!-- END / ITEM -->

                                                </div>

                                                <div class="checkout_cartinfo">
                                                    <p><span>Order Total:</span> <span class="color-red">(total price)</span></p>
                                                </div>

                                                <div class="checkout_option checkout-content">
                                                    <ul>
                                                        <li>
                                                            <input type="radio" class="radio payment-methor" name="payment">
                                                            <h6>Direct Bank Transfer</h6>
                                                            <p>Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order wonâ€™t be shipped until the funds have cleared in our account.</p>
                                                        </li>
                                                        <li>
                                                            <input type="radio" class="radio payment-methor" name="payment">
                                                            <h6>Cheque Payment</h6>
                                                        </li>
                                                        <li>
                                                            <input type="radio" class="radio payment-methor" name="payment">
                                                            <h6>Credit Card</h6>
                                                        </li>
                                                    </ul>
                                                </div>

                                                <div class="checkout_btn">
                                                    <button type="submit" id="confirm" onclick="confirmSubmit(event)"
                                                            class="button confirm-content">
                                                        Confirm
                                                    </button>
                                                    <button type="submit" id="back" class="button checkout-content"
                                                            onclick="window.location.href='http://localhost:8080/product/list'">
                                                        Back to product list
                                                    </button>
                                                    <button type="submit" id="cancel" onclick="cancelSubmit(event)"
                                                            class="button checkout-content">
                                                        Cancel
                                                    </button>
                                                    <button type="submit" id="checkout" onclick="checkoutSubmit(event)"
                                                            class="button checkout-content">
                                                        Check out
                                                    </button>
                                                </div>
                                            </div>

                                        </div>
                                    </form>

                                <div th:unless="${orderProduct}!= null">
                                    <h1>You haven't added any items to cart!</h1>
                                    <button class="button" onclick="window.location.href='http://localhost:8080/product/list'">
                                        Back to product list
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- END / BLOG -->

        </section>

        </div>

        <div th:replace="fragment/footer :: footer"></div>
    </div>

    <script th:src="@{/js/jquery-2.2.4.min.js}"></script>
    <script th:src="@{/js/common_scripts_min.js}"></script>
    <script th:src="@{/assets/validate.js}"></script>
    <script th:src="@{/js/functions.js}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.11/js/bootstrap-select.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@7.1.0/dist/promise.min.js"></script>
    <script th:src="@{/sweetalert2/dist/sweetalert2.all.js}"></script>
    <script>
        // Give the parameter a variable name
        var orderProductId = getParameterByName('orderProductId');

        $(document).ready(function () {
            if (orderProductId == null || orderProductId == '') {
                $('.confirm-content').show();
            }
            else {
                $('.confirm-content').hide();
                $('.checkout-content').show();
            }
        });

        function confirmSubmit(e) {
            e.preventDefault();
            Swal.fire({
                title: 'Are you sure!',
                text: 'Do you want to confirm this order?',
                icon: 'question',
                confirmButtonText: 'Yes',
                showCancelButton: true
            }).then(function(result){
                if (result.value){
                    $("#formform").attr("action", "/cart/confirm");
                    $("#formform").attr("method", "post");
                    $("#formform").submit();
                } else {
                    return false;
                }
            });
        }
        function cancelSubmit(e) {
            e.preventDefault();
            Swal.fire({
                title: 'Are you sure!',
                text: 'Do you want to cancel this order?',
                icon: 'question',
                confirmButtonText: 'Yes',
                showCancelButton: true
            }).then(function(result){
                if (result.value){
                    $("#formform").attr("action", "/cart/cancel");
                    $("#formform").attr("method", "post");
                    $("#formform").submit();
                } else return false;
            });
        }
        function checkoutSubmit(e) {
            e.preventDefault();
            Swal.fire({
                title: 'Are you sure!',
                text: 'Choose the payment method?',
                icon: 'question',
                confirmButtonText: 'Yes',
                showCancelButton: true
            }).then(function(result){
                if (result.value){
                    $("#formform").attr("action", "/cart/checkout");
                    $("#formform").attr("method", "post");
                    $("#formform").submit();
                } else return false;
            });
        }

        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
    </script>
</body>
</html>